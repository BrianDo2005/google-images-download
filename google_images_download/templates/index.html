<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Google image download server</title>
    <!--<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">-->
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
  </head>
  <body>
    {% with messages = get_flashed_messages() %}
      {% if messages %}
       <ul class=flashes>
       {% for message in messages %}
         <li>{{ message }}</li>
       {% endfor %}
       </ul>
      {% endif %}
    {% endwith %}
    <p>Welcome to Google Image Download Server </p>
    <form method="POST" action="{{ url_for('index') }}">
      {{ form.csrf_token }}
      {{ form.query.label }} {{ form.query(size=20) }}
      <br><br>
      {{ form.starting }}
      {{ form.ending }}
      <input type="submit" value="Go">
    </form>
    {% if query %}
    <p> query is {{query}}</p>
    {% endif %}
    {% if debug_info %}
      <ul>
      {% for key, value in debug_info.items() %}
        {% if key == 'url' %}
	<li>{{key}}: <a href="{{value}}">{{ value.split('://')[1] }}</a></li>
        {% elif key == 'dump_html' %}
	<li>{{key}}: <a href="file://{{value[0]}}">{{ value[1] }}</a></li>
	{% else %}
        <li>{{key}}: {{value}}</li>
        {% endif %}
      {% else %}
        <li> Empty debug info</li>
      {% endfor %}
      </ul>
    {% endif %}

    {% if result %}
    <h5>Match result</h5>
    {% for entry in result['match'] %}
      <div>
	<img src='{{entry['json_data'][0]['tu']}}'>
        <ul>
          {% for key, value in entry['json_data'][0].items()|sort %}
          <li>{{key}}: {{value}}</li>
          {% endfor %}
        </ul>
      </div>
    {% endfor %}
    {% endif %}
  </body>
</html>
